# LyricNext

AstrBot 歌词接龙插件，当你发送一句歌词，机器人会回复下一句。

## 功能特点

- 支持本地歌词库，用户可自定义添加歌词
- 支持网易云音乐、QQ音乐、酷狗音乐三大平台歌词检索
- 优化的歌词匹配算法，提高识别准确率
- 歌词文件自动过滤，保持纯净的歌词内容

## 使用方法

### 基本功能
1. **歌词接龙**: 直接发送歌词，机器人会匹配并回复下一句
2. **搜索歌词**: `/lyric search <歌名> [歌手名] [音乐源]` - 搜索并添加歌词到歌词库
3. **查看列表**: `/lyric list` - 列出所有已添加的歌曲
4. **查看歌词**: `/lyric view <歌曲名>` - 查看指定歌曲的完整歌词内容
5. **重新加载**: `/lyric reload` - 重新加载歌词库
6. **查看帮助**: `/lyric help` - 查看详细使用帮助

### 搜索歌词参数

`/lyric search` 命令支持以下几种参数输入方式：

- `/lyric search 晴天` - 只指定歌名
- `/lyric search 晴天 周杰伦` - 指定歌名和歌手名  
- `/lyric search 晴天 周杰伦 QQ音乐` - 指定歌名、歌手名和音乐源

### 音乐源参数

在使用 `/lyric search` 命令时，可以指定音乐源参数以精确搜索特定平台的歌词，支持的音乐源包括：

- `网易云`、`netease` - 从网易云音乐搜索歌词
- `QQ音乐`、`qq` - 从QQ音乐搜索歌词
- `酷狗`、`kugou` - 从酷狗音乐搜索歌词

例如：`/lyric search 晴天 周杰伦 QQ音乐` 将从QQ音乐搜索周杰伦的《晴天》。

## 批量下载工具

### 自动下载歌手全部歌曲
如需批量下载某个歌手的所有歌曲，可以运行：
```bash
python tools/fetch_lyrics.py
```
该工具支持：
- 选择不同音乐平台（网易云、QQ音乐、酷狗音乐）
- 批量下载指定歌手的所有歌曲歌词
- 自动过滤和保存纯净歌词文件

### 单独搜索歌曲
也可以单独运行搜索工具：
```bash
python tools/search_lyrics.py
```
用于单独搜索和下载特定歌曲的歌词。

## 数据存储
- 初始化带了一些我测试的歌词数据 大部分为周杰伦 可自行删除或替换
- 为方便提前下载和管理歌词，歌词文件未存储在 AstrBot/data根目录下 迁移时注意自行备份
- 歌词文件存储在 `Astrbot/data/plugins/astrbot_plugin_lyricnext/data/lyrics` 目录下
- 每首歌一个文本文件
- 歌词文件经过智能过滤，只保留纯净的歌词内容
- 自动去除作词、作曲、编曲等信息行

## 配置选项

可通过 AstrBot 配置界面调整以下参数：
- `preprocess_lyrics`: 是否预处理歌词以提高匹配准确率
- `match_threshold`: 歌词匹配阈值,默认0.8（0.1-1.0，越高越精确）

